## CUSTOMERS ##

CREATE OR REPLACE TABLE STG_CUSTOMERS AS
SELECT
    CUSTOMER_ID,
    TRIM(CUSTOMER_NAME) AS CUSTOMER_NAME,
    UPPER(REGION) AS REGION
FROM RAW_CUSTOMERS;

##PRODUCTS##
CREATE OR REPLACE TABLE STG_PRODUCTS AS
SELECT
    PRODUCT_ID,
    TRIM(PRODUCT_NAME) AS PRODUCT_NAME,
    CATEGORY
FROM RAW_PRODUCTS;

## ORDERS ##
CREATE OR REPLACE TABLE STG_ORDERS AS
SELECT
    ORDER_ID,
    CUSTOMER_ID,
    PRODUCT_ID,
    QUANTITY,
    PRICE,
    QUANTITY * PRICE AS TOTAL_AMOUNT,
    ORDER_DATE
FROM RAW_ORDERS
WHERE ORDER_DATE IS NOT NULL;

